<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Demo 06 Log</title>

   <!-- Example to add a button to create a download link
     http://jsfiddle.net/UselessCode/qm5AG/#
   -->
   <style type="text/css">
     header { color: blue; }
   </style>
<script>
    var logString = "";

    // add date -> msg to the logString
    function log(msg) {
      if (msg=="") return;
      var date = new Date();
      var logmsg = date.getMonth() + "/" + date.getDate() + "/" + date.getFullYear() + " -> " + msg;
      logString += logmsg + "<br>";
      document.getElementById("log").innerHTML = logString;
    }

    function clearLog() {
      logString = "";
      document.getElementById("log").innerHTML = logString;
    }

    // From: https://stackoverflow.com/questions/13405129/javascript-create-and-save-file
    function download(text, name, type) {
        var a = document.getElementById("log");
        var file = new Blob([text], {type: type});
        a.href = URL.createObjectURL(file);
        a.download = name;
    }
</script>
</head>

<body>
  <header>
    <h1>Demo 6 Log</h1>
  </header>

  <p>TODO: complete implementation</p>

  <button id="clear" onclick="clearLog()">Clear Log</button><br>
  <input type="text" id="msg" onchange="log(this.value);" /><br>
  <p id="log" background-color="yellow"></p>
  <button onclick="download(document.getElementById('log'), 'log.txt', 'text/plain')">Save log to a file (not working yet)</button>

  <script>
    var logfile= 'log.txt';
    set fso = CreateObject("Scripting.FileSystemObject"); 
    set s   = fso.CreateTextFile(logfile, True);
 
    var firstName = document.getElementById('log');
 
    s.writeline("First Name :" + FirstName);
    s.writeline("Last Name :" + lastName);
 
    s.writeline("-----------------------------");
    s.Close();
  </script>
</body>

</html>
